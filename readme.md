# Experiments for the paper *Unichain and Aperiodicity are Sufficient for Asymptotic Optimality of Average-Reward Restless Bandits*

This project contains the experiment code for the paper: 
Yige Hong, Qiaomin Xie, Yudong Chen, Weina Wang (2024). 
[Unichain and Aperiodicity are Sufficient for Asymptotic Optimality of Average-Reward Restless Bandits](https://arxiv.org/abs/2402.05689).



## Python version and packages
- python 3.10
- cvxpy 1.3.1
- numpy 1.24.2
- scipy 1.10.1
- matplotlib 3.7.1

## Reproduce the experiments
Sequentially run `experiments2.py`, `plot_figuers.py`, `understand_assumptions.py`, and `understand_id_and_set_expansion.py`,
following in the instructions in each file. 
All figures will be generated in the folder `figs2`.

## File organization
`discrete_RB.py`: 
- This file defines the primary classes and functions used to run the RB
simulations, including:
  - The `RB` class, which serves as the main simulation environment.
  - A helper class for solving single-arm LPs, LP index, and Whittle index.
  - Implementations of various RB policies (e.g., LP-Priority policies, ID, Set-Expansion).
  - Other utility functions.

`rb_settings.py`
- Defines the classes for various Restless Bandit (RB) instances.

`experiments2.py`
- Primary simulation script for evaluating policies in various Restless
Bandit (RB) instances. 

`plot_figuers.py`
- Generates the plots and figures from saved experimental data of experiments2.py

`understand_assumptions.py`
- Generates a population of randomly Restless Bandit (RB) instances
and calculates statistics. 

`understand_id_and_set_expansion.py`
- The Performs a detailed analysis of the ID and set-expansion policies,
comparing the persistency of pibar* under ID policy and set-expansion policy

Some file folders:
- `setting_data`: the specifications of some randomly-generated RB instances
- `fig_data`: simulation data after running `experiments2.py`
- `random_example_data`: checkpoint data after running `understand_assumptions.py`
- `figs2`: all figures generated by running 
`experiments2.py` `understand_assumptions.py` and `understand_id_and_set_expansion.py`


